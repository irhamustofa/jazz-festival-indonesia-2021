<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jazz Festival Indonesia 2021</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Philosopher:wght@400;700&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta2/css/all.min.css"
        integrity="sha512-YWzhKL2whUzgiheMoBFwW8CKV4qpHQAEuvilg9FAn5VJUDwKZZxkJNuGM4XkWuk94WCrrwslk8yWNGmY1EduTA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link rel="stylesheet" href="./resources/css/style.css">
</head>

<body>

    <!-- Navigation bar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
            <a class="navbar-brand" href="#">
                <img src="resources/images/jfi-logo-small.png" alt="Jazz Festival Indonesia 2021" class="img-fluid">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="#ticket">Ticket</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="#lineup">Line-up</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="#gallery-content">Gallery</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="#contact">Contact</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <section id="header">
        <div class="container pt-5">

            <div class="row align-items-center text-center">
                <div class="col-md-8 offset-md-2 px-5">
                    <div class="content-container">
                        <h1 class="mb-4">Join us and enjoy the tunes!</h1>
                        <p class="mb-5">Be one of the first people to get an amazing experience this year.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="registration">
        <div class="container">
            <div class="row">
                <div class="col">
                    <h2 class="section-title text-center mb-5">Register</h2>
                </div>
            </div>

            <form method="POST" action="./controller/RegisterController.php" class="row">
                <div class="col-md-8 ps-5 pe-3">
                    <div class="form-group mb-4">
                        <label for="name">Name</label>
                        <input id="name" name="name" type="text" class="form-control" onchange="updateData()" />
                    </div>
                    <div class="form-group mb-4">
                        <label for="email">Email</label>
                        <input id="email" name="email" type="text" class="form-control" onchange="updateData()" />
                    </div>
                    <div class="form-group mb-4">
                        <label for="address">Address</label>
                        <textarea name="address" id="address" class="form-control" cols="30" rows="5"
                            onchange="updateData()"></textarea>
                    </div>

                    <div class="form-group mb-4">
                        <label for="" class="mb-3">Category</label>
                        <div class="ticket-category-container">

                            <div class="ticket-category-item category-full-pass">
                                <input id="category-full-pass" type="radio" name="category" onchange="updateData()"
                                    value="full-pass" />
                                <label for="category-full-pass">
                                    <div class="card">
                                        <div class="card-body">
                                            <span class="">Best Value</span>
                                            <h3 class="mb-3">Full Pass</h3>
                                            <p>Get all the event experiences, amazing merchs, and many more.</p>
                                        </div>
                                    </div>
                                </label>
                            </div>

                            <div class="ticket-category-item category-daily-pass">
                                <input id="category-daily-pass" type="radio" name="category" onchange="updateData()"
                                    value="daily-pass" />
                                <label for="category-daily-pass">
                                    <div class="card">
                                        <div class="card-body">
                                            <h3 class="mb-3">Daily Pass</h3>
                                            <p>Enjoy a day experience and a free merch</p>
                                        </div>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group mb-4">
                        <label for="ticket-total" class="mb-3">Ticket Total</label>
                        <div class="row">
                            <div class="col-md-2">
                                <input id="ticket-total" name="ticket_total" type="number"
                                    class="form-control d-inline-block" min="1" max="15" onchange="updateData()" />
                            </div>
                        </div>
                    </div>

                </div>
                <div class="col-md-4 pe-5">
                    <div class="card mb-4">
                        <div class="card-body">
                            <h5 class="mb-3">Event Detail</h5>

                            <div class="row mb-4">
                                <div class="col">
                                    <span class="text-muted">Location</span>
                                    <h5>Jakarta Convention Center</h5>
                                    <p class="mb-0">Jl. Gatot Subroto, Kecamatan Tanah Abang, Kota Jakarta Pusat, DKI
                                        Jakarta 10270</p>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col">
                                    <span class="text-muted">Date</span>
                                    <h5>18 - 20 January 2023</h5>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card overview-card">
                        <div class="card-body">
                            <h5 class="mb-3">Overview</h5>

                            <div class="form-group border-bottom pb-4">
                                <div class="row mb-4">
                                    <div class="col">
                                        <span class="text-muted">Name</span>
                                        <h5 id="overview-name" class="m-0">-</h5>
                                    </div>
                                </div>

                                <div class="row mb-4">
                                    <div class="col">
                                        <span class="text-muted">Email</span>
                                        <h5 id="overview-email" class="m-0">-</h5>
                                    </div>
                                </div>

                                <div class="row mb-4">
                                    <div class="col">
                                        <span class="text-muted">Address</span>
                                        <h5 id="overview-address" class="m-0">-</h5>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col">
                                        <span class="text-muted">Category</span>
                                        <h5 id="overview-category" class="m-0">-</h5>
                                    </div>
                                    <div class="col">
                                        <span class="text-muted">Ticket(s)</span>
                                        <h5 id="overview-ticket-total" class="m-0">-</h5>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group pt-4">
                                <label for="total-price">Total Price</label>
                                <h2 id="overview-total-price">0,00</h2>

                                <input type="hidden" name="total_price">
                            </div>

                            <div class="form-group my-3">
                                <button class="btn btn-round btn-primary text-light">Register</button>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </section>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous">
    </script>

    <script type="text/javascript">
        const updateData = () => {
            let data = {
                name: document.querySelector('[name="name"]').value,
                email: document.querySelector('[name="email"]').value,
                address: document.querySelector('[name="address"]').value,
                category: document.querySelector('[name="category"]:checked').value,
                ticketTotal: document.querySelector('[name="ticket_total"]').value,
            }

            updateOverview(data)
        }

        const updateOverview = (data) => {
            let overviewNameEl = document.querySelector('#overview-name')
            let overviewEmailEl = document.querySelector('#overview-email')
            let overviewAddressEl = document.querySelector('#overview-address')
            let overviewCategoryEl = document.querySelector('#overview-category')
            let overviewTicketTotalEl = document.querySelector('#overview-ticket-total')
            let overviewTotalPriceEl = document.querySelector('#overview-total-price')

            if (data.name) {
                overviewNameEl.innerHTML = data.name
            }
            if (data.email) {
                overviewEmailEl.innerHTML = data.email
            }
            if (data.address) {
                overviewAddressEl.innerHTML = data.address
            }
            if (data.category) {
                let category = 'Daily Pass'
                if (data.category == 'full-pass') {
                    category = 'Full Pass'
                }

                overviewCategoryEl.innerHTML = category
            }
            if (data.ticketTotal) {
                overviewTicketTotalEl.innerHTML = data.ticketTotal
            }

            if (data.ticketTotal && data.category) {
                let totalPrice = 0
                let price = 70000 // Daily pass

                if (data.category == 'full-pass') {
                    price = 140000
                }

                let totalPriceEl = document.querySelector("[name='total_price']")

                totalPrice = price * data.ticketTotal
                overviewTotalPriceEl.innerHTML = new Intl.NumberFormat('id-ID', {
                    style: 'currency',
                    currency: 'IDR'
                }).format(totalPrice)

                totalPriceEl.value = totalPrice
            }
        }

        const setCategory = (category) => {
            document.querySelector('[name="category"][value="' + category + '"]').checked = true
            updateData()
        }

        document.addEventListener('DOMContentLoaded', () => {
            // If has param 'category'
            const params = new URL(location).searchParams
            if (params.get('category')) {
                setCategory(params.get('category'))
            }
        })
    </script>
</body>

</html>